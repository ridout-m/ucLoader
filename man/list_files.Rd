% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/uc_loader.R
\name{list_files}
\alias{list_files}
\title{List files in a Unity Catalog directory}
\usage{
list_files(dir, pattern = NULL, ignore_case = FALSE)
}
\arguments{
\item{dir}{Character scalar. A Unity Catalog directory path beginning with
\verb{/Volumes/}.}

\item{pattern}{Optional character scalar. A regular expression used to filter
results by \code{name}.}

\item{ignore_case}{Logical; passed to \code{grepl(ignore.case = ...)} when
\code{pattern} is provided.}
}
\value{
A \code{data.frame} with columns:
\describe{
\item{name}{File name.}
\item{path}{Full UC path.}
\item{file_size_MB}{File size in MiB, rounded to 2 decimals.}
\item{last_modified}{POSIXct timestamp in UTC.}
}
If the directory exists but has no \code{contents}, returns \code{NULL} invisibly.
}
\description{
Lists the contents of a Unity Catalog volume directory (a path beginning with
\verb{/Volumes/}) using the Databricks Files API directories endpoint and returns
a \code{data.frame} of files with basic metadata. If \code{pattern} is supplied, results
are filtered by filename using regular expressions.
}
\details{
Calls \code{connect(FALSE)} to ensure \code{DATABRICKS_HOST} and \code{DATABRICKS_TOKEN} are
available. The directory path is URL-encoded and requested as JSON. The API
returns \code{last_modified} as milliseconds since epoch; this is converted to a
UTC \code{POSIXct}. File sizes are converted from bytes to MiB.

Progress and errors are reported via \code{cli}. Transport failures trigger
\code{cli::cli_abort()}.
}
\examples{
\dontrun{
# List everything
list_files("/Volumes/cat/schema/volume/path")

# Filter by extension (regex) and ignore case
list_files("/Volumes/cat/schema/volume/path", pattern = "\\\\\\\\.rds$", ignore_case = TRUE)
}

}
