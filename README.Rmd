---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# ucLoader

<!-- badges: start -->
<!-- badges: end -->

Load files from Databricks Unity Catalog (UC) into R with a simple, consistent interface. Works smoothly on RStudio Server running on Databricks.

## What it does

- Talks to UC Volumes via the Databricks REST API
- Downloads to a local temp file and loads with base/readr/readxl/etc.
- Uploads local files back to UC
- Lists directory contents in UC (size, modified time, paths)

## Requirements

Environment variables:

- DATABRICKS_HOST: Databricks workspace URL (set by your cluster BusAdmin or can be entered manually)
- DATABRICKS_TOKEN: Databricks PAT (Personal Access Token)

Notes:

- PAT entry is masked. 
- The token is stored only in the current R process environment, read only when needed, and never persisted by ucLoader.

## Installation

Install the development version from GitHub:

``` r
install.packages("remotes")
remotes::install_github("ridout-m/ucLoader")
library(ucLoader)
```

## Functions

```connect(show_success = TRUE)```
- Ensures DATABRICKS_HOST/DATABRICKS_TOKEN are present and valid (prompts if needed).

```UC_list_files(dir, pattern = NULL)```
- Lists files in a UC directory (not recursive). Returns name, file_size_MB, last_modified (POSIXct UTC), path.

```download(path)```
- Downloads a UC file to a temp path, you can then read it with any reader.

```upload(local_path, dest_uc_path, overwrite = TRUE)```
- Uploads a local file to a UC path.

```UC_load(path, envir = parent.frame())```
- Downloads a .RData / .rda and loads objects into envir.

```UC_read.csv(path, ..., stringsAsFactors = FALSE)```
- Downloads a CSV and reads it with utils::read.csv().

```UC_save(file, path, overwrite = TRUE)```
- Saves an object to a local .RData then uploads to UC.

## Development notes

README.md is generated from README.Rmd.

## License

MIT.
